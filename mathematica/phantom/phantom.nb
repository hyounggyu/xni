(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     13319,        381]
NotebookOptionsPosition[     11913,        327]
NotebookOutlinePosition[     12291,        344]
CellTagsIndexPosition[     12248,        341]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Phantom3D", "Chapter",
 CellChangeTimes->{{3.6303621139933167`*^9, 3.630362116598289*^9}, {
  3.630382465823413*^9, 3.6303824690115767`*^9}, {3.630382639218523*^9, 
  3.630382641142062*^9}, {3.6306323649499617`*^9, 3.6306323672102833`*^9}}],

Cell[CellGroupData[{

Cell["Phantom 3D Volume Rendering", "Section",
 CellChangeTimes->{{3.630461762830947*^9, 3.630461767557589*^9}, {
  3.630634832068233*^9, 3.6306348383792543`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"Phantom3DRegion", "[", 
    RowBox[{"{", 
     RowBox[{"RotationTransform", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.630395276480304*^9, 3.630395349052293*^9}, {
  3.630466581887068*^9, 3.63046658235574*^9}, {3.6314142403246193`*^9, 
  3.631414262033169*^9}, {3.6314145759961853`*^9, 3.631414584151113*^9}, {
  3.631416429737359*^9, 3.631416436891478*^9}, {3.631416679711625*^9, 
  3.631416694193655*^9}, {3.6314168963169203`*^9, 3.6314169045829487`*^9}, {
  3.6314170716543713`*^9, 3.6314171017888813`*^9}, {3.631420857710617*^9, 
  3.631420870456716*^9}, {3.633311641259029*^9, 3.6333116414902678`*^9}, {
  3.633747786884509*^9, 3.633747817420735*^9}, {3.633750001020652*^9, 
  3.633750021892445*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Phantom3DRegionToImage3D", "[", 
    RowBox[{"region", ",", "200"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.633750026065798*^9, 3.6337500322861347`*^9}}],

Cell[BoxData[
 RowBox[{"Image3DSlices", "[", 
  RowBox[{
   RowBox[{"ImageMultiply", "[", 
    RowBox[{"data", ",", "0.5"}], "]"}], ",", "All", ",", "3"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.630396433147599*^9, 3.63039646706916*^9}, {
  3.63375004290967*^9, 3.633750047216679*^9}, {3.6337500786720037`*^9, 
  3.633750123777269*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phantom Rotation", "Section",
 CellChangeTimes->{{3.630461735668189*^9, 3.630461754460966*^9}, {
  3.630634827503471*^9, 3.630634829548345*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"regions", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Phantom3DRegion", "[", 
      RowBox[{"{", 
       RowBox[{"RotationTransform", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "}"}], "]"}], 
     "&"}], "/@", 
    RowBox[{"Table", "[", 
     RowBox[{"\[Theta]", ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]", ",", 
        FractionBox["\[Pi]", "8"]}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.630396568243231*^9, 3.6303966021386137`*^9}, {
   3.630396637406382*^9, 3.630396638628778*^9}, {3.630652687818555*^9, 
   3.630652694552493*^9}, {3.631414319440474*^9, 3.631414329802209*^9}, {
   3.631414363339032*^9, 3.631414370878995*^9}, {3.631414406088731*^9, 
   3.631414409950419*^9}, {3.631414531401582*^9, 3.631414569164483*^9}, {
   3.631414613984085*^9, 3.631414648644784*^9}, 3.631414693018298*^9, {
   3.631414723631662*^9, 3.631414782618952*^9}, {3.631416104517376*^9, 
   3.631416105122408*^9}, 3.631417158263865*^9, {3.631417203192178*^9, 
   3.6314172232221518`*^9}, {3.631420878322111*^9, 3.6314208809101257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Phantom3DRegionToImage3D", "[", 
    RowBox[{"#", ",", "100"}], "]"}], "&"}], "/@", "regions"}]], "Input",
 CellChangeTimes->{{3.630396658075794*^9, 3.630396658313499*^9}, {
  3.63039669007725*^9, 3.63039670848562*^9}, {3.630396770749878*^9, 
  3.6303967842070436`*^9}, {3.630653765163413*^9, 3.630653766221587*^9}, {
  3.633750138504759*^9, 3.6337501760600348`*^9}, {3.633750231468315*^9, 
  3.633750278019421*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phantom Transmission Image", "Section",
 CellChangeTimes->{{3.630461809507539*^9, 3.630461818186158*^9}, 
   3.630461853469234*^9, {3.630632139545857*^9, 3.630632139647999*^9}, {
   3.6306348438018827`*^9, 3.630634843948152*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"Phantom3DRegion", "[", 
    RowBox[{"{", 
     RowBox[{"RotationTransform", "[", 
      RowBox[{
       FractionBox["\[Pi]", "4"], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.630461897563425*^9, 3.630461907959258*^9}, {
  3.6306328057381*^9, 3.630632807984021*^9}, {3.63141726521626*^9, 
  3.631417270112104*^9}, {3.631420884072006*^9, 3.631420886311717*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"range", "=", 
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"-", "1."}], ",", "1.", ",", "0.008"}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"points", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "range"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "range"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "range"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6304619343543*^9, 3.630461936609783*^9}, 
   3.630462135774619*^9, {3.630463846442885*^9, 3.6304638722256203`*^9}, {
   3.6304639684015493`*^9, 3.63046396872924*^9}, {3.633750299805982*^9, 
   3.633750301107069*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Phantom3DRegionToData", "[", 
    RowBox[{"region", ",", "points"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "@", "data"}]}], "Input",
 CellChangeTimes->{{3.63046214374879*^9, 3.630462149110009*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "All", ",", "z"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", "1", ",", 
      RowBox[{"Length", "[", "range", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Apply", "[", 
   RowBox[{"Plus", ",", "%", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Max", "@", "%"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Image", "@", 
  RowBox[{"(", 
   RowBox[{"%%", "/", "%"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.630461473338546*^9, 3.630461488841394*^9}, {
  3.6304615229139147`*^9, 3.630461566117509*^9}, {3.6304616204699507`*^9, 
  3.630461663161531*^9}, {3.630632446301279*^9, 3.630632459180842*^9}, {
  3.6306325201437073`*^9, 3.630632534362235*^9}, {3.630632581052412*^9, 
  3.630632587927174*^9}, {3.6306326195491867`*^9, 3.6306326418343277`*^9}, {
  3.630632696205159*^9, 3.630632700828261*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reconstruction", "Section",
 CellChangeTimes->{{3.630461809507539*^9, 3.630461818186158*^9}, 
   3.630461853469234*^9, {3.63047232502594*^9, 3.630472325144351*^9}, {
   3.630548114765057*^9, 3.6305481148536453`*^9}, {3.630632136925313*^9, 
   3.630632137048306*^9}, {3.630634799600842*^9, 3.630634806643482*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"regions", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Phantom3DRegion", "[", 
      RowBox[{"{", 
       RowBox[{"RotationTransform", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "}"}], "]"}], 
     "&"}], "/@", 
    RowBox[{"Table", "[", 
     RowBox[{"\[Theta]", ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]", ",", 
        FractionBox["\[Pi]", "180"]}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.630461897563425*^9, 3.630461907959258*^9}, {
   3.630472331497147*^9, 3.6304723568596888`*^9}, 3.6304885947667933`*^9, {
   3.6305481189833612`*^9, 3.6305481195703297`*^9}, {3.63141900613415*^9, 
   3.631419019022481*^9}, {3.631420889867941*^9, 3.6314208932173023`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"range", "=", 
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1", ",", "0.008"}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"points", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{"-", "0.25"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "range"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "range"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6304619343543*^9, 3.630461936609783*^9}, 
   3.630462135774619*^9, {3.630463846442885*^9, 3.6304638722256203`*^9}, {
   3.6304639684015493`*^9, 3.63046396872924*^9}, {3.6306320473582153`*^9, 
   3.630632056905341*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Phantom3DRegionToData", "[", 
      RowBox[{"#", ",", "points"}], "]"}], "&"}], "/@", "regions"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6304886319382353`*^9, 3.63048864058479*^9}, {
  3.630488683758025*^9, 3.6304887025130157`*^9}, {3.630548130697822*^9, 
  3.630548158572204*^9}, {3.630548236873744*^9, 3.6305482487759857`*^9}, {
  3.6305491475877666`*^9, 3.630549159341073*^9}, {3.630633029465398*^9, 
  3.6306330353558273`*^9}}],

Cell[BoxData[
 RowBox[{"Image3D", "[", 
  RowBox[{"data", "/", 
   RowBox[{"Max", "[", "data", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.630633146638129*^9, 3.63063315874576*^9}, {
  3.6306332081888533`*^9, 3.630633208435314*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Apply", "[", 
   RowBox[{"Plus", ",", "data", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Image", "[", 
  RowBox[{"%", "/", 
   RowBox[{"Max", "@", "%"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InverseRadon", "[", 
   RowBox[{"Image", "@", 
    RowBox[{"Transpose", "@", 
     RowBox[{"ImageData", "@", "%"}]}]}], "]"}], "//", 
  "ImageAdjust"}]}], "Input",
 CellChangeTimes->{{3.630634612964342*^9, 3.630634636286421*^9}, {
  3.630634752861443*^9, 3.630634783608534*^9}, {3.630635668858344*^9, 
  3.6306356760763073`*^9}, {3.630641863254417*^9, 3.630641898617556*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transform", "Section",
 CellChangeTimes->{{3.630461809507539*^9, 3.630461818186158*^9}, 
   3.630461853469234*^9, {3.63047232502594*^9, 3.630472325144351*^9}, {
   3.630548114765057*^9, 3.6305481148536453`*^9}, {3.630632136925313*^9, 
   3.630632137048306*^9}, {3.630634799600842*^9, 3.630634806643482*^9}, {
   3.63130908601392*^9, 3.631309086496543*^9}, {3.633750374880172*^9, 
   3.6337503770825243`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Phantom3DRegion", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RotationTransform", "[", 
      RowBox[{
       FractionBox["\[Pi]", "4"], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"TranslationTransform", "[", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0.5", ",", "0"}], "}"}], "]"}]}], "}"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RegionPlot3D", "[", 
  RowBox[{"%", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"All", ",", "All", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.631432478317195*^9, 3.6314326501498957`*^9}, {
  3.631432735167994*^9, 3.631432800435615*^9}}]
}, Open  ]]
}, Open  ]]
},
Evaluator->"CUDA",
WindowSize->{1218, 863},
WindowMargins->{{Automatic, 12}, {Automatic, 54}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 246, 3, 65, "Chapter"],
Cell[CellGroupData[{
Cell[693, 22, 163, 2, 64, "Section"],
Cell[859, 26, 893, 18, 28, "Input"],
Cell[1755, 46, 222, 5, 28, "Input"],
Cell[1980, 53, 339, 8, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2356, 66, 150, 2, 64, "Section"],
Cell[2509, 70, 1183, 25, 46, "Input"],
Cell[3695, 97, 463, 9, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4195, 111, 235, 3, 64, "Section"],
Cell[4433, 116, 521, 13, 45, "Input"],
Cell[4957, 131, 876, 24, 46, "Input"],
Cell[5836, 157, 286, 7, 46, "Input"],
Cell[6125, 166, 1031, 25, 80, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7193, 196, 318, 4, 64, "Section"],
Cell[7514, 202, 824, 20, 46, "Input"],
Cell[8341, 224, 835, 23, 46, "Input"],
Cell[9179, 249, 524, 12, 28, "Input"],
Cell[9706, 263, 236, 5, 28, "Input"],
Cell[9945, 270, 661, 16, 63, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10643, 291, 414, 6, 64, "Section"],
Cell[11060, 299, 825, 24, 64, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

